{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["'use strict'\n\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport Axios from \"axios\";\n\n\nconst refs = {\n    formEl: document.querySelector('.form'),\n    input: document.querySelector('.valueGallery'),\n    galleryEl: document.querySelector('.gallery'),\n    loader: document.querySelector('.loader'),\n    btnLoad: document.querySelector('.btn-load'),\n    \n}\n\nlet _page = 1;\nconst limit = 15;\nlet totalPages = 0;\nlet value = '';\n\nrefs.formEl.addEventListener('submit', onFormSubmit);\nrefs.loader.style.visibility = 'hidden';\n\nasync function onFormSubmit(e) {\n    e.preventDefault();\n    refs.galleryEl.innerHTML = '';\n    refs.btnLoad.style.visibility = 'hidden';\n    value = e.target.elements.valueGallery.value.trim();\n    if (value !== '') {\n        refs.loader.style.visibility = 'visible';\n    } \n    _page = 1;\n    try {\n        const data = await getUrl();\n        if (data.hits.length > 0 & value !== '') {\n            refs.loader.style.visibility = 'hidden';\n            renderImages(data.hits);\n            refs.btnLoad.style.visibility = 'visible';\n        } else {\n            refs.loader.style.visibility = 'hidden';\n            iziToast.error({\n                message: 'Sorry, there are no images matching your search query. Please try again!',\n                position: 'topRight',\n            })\n        }\n    } catch (err) {\n        totalPages = 0;\n        checkTotalHits(totalPages);\n    }\n    e.target.reset();\n};\n\n\nconst axios = Axios.create({\n    baseURL: 'https://pixabay.com/api/',\n    \n})\nasync function getUrl() {\n    const response =await axios.get('',{params: {\n        key: '42132466-2eec74b8e2a534f613ea758a4',\n        q: value,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        per_page: limit,\n        page: _page,\n        \n    }\n    });\n    return response.data;\n}\nfunction imageTemplate(img) {\n    const {webformatURL, largeImageURL, tags, likes, views, comments, downloads} = img;\n    return `<li>\n    <div class=\"card\">\n    <div class=\"img-container\">\n    <a href=\"${largeImageURL}\">\n    <img src=\"${webformatURL}\" alt=\"${tags}\" />\n    </a>\n    </div>\n    <div class=\"img-comments\">\n    <p class=\"describe\">Likes ${ likes }</p>\n    <p class=\"describe\">Views ${ views }</p>\n    <p class=\"describe\">Comments ${ comments }</p>\n    <p class=\"describe\">Downloads ${downloads}</p>\n    </div>\n    </div>\n    </li>\n    `;\n}\nfunction imagesTemplate(images) {\n    return images.map(imageTemplate).join('');\n}\nfunction renderImages(images) {\n    const markup = imagesTemplate(images) ;\n    refs.galleryEl.insertAdjacentHTML('beforeend',markup);\n    let simpleLightBox = new SimpleLightbox('.gallery a', { captionsData: 'alt', captionDelay: 250 }).refresh();\n};\n\n\nrefs.btnLoad.addEventListener('click', onBtnLoadClick);\n\nasync function onBtnLoadClick() {\n    _page += 1; \n    refs.loader.style.visibility = 'visible';\n    const data = await getUrl();\n    renderImages(data.hits);\n    checkTotalHits(data.totalHits);\n    refs.loader.style.visibility = 'hidden';\n    const card = document.querySelector('.card');\n    let rect = 2 * card.getBoundingClientRect().height;\n    window.scrollBy({\n    top: rect,\n    behavior: 'smooth',\n});\n} \n\nfunction checkTotalHits(totalHits) {\n    totalPages = Math.ceil(totalHits / limit);\n    if (totalPages<=_page) { \n        refs.btnLoad.style.visibility = 'hidden';\n        return iziToast.error({\n        position: \"topRight\",\n        color: 'blue',\n        message: \"We're sorry, there are no more posts to load\"\n        });\n    };\n    }\n"],"names":["refs","_page","limit","totalPages","value","onFormSubmit","e","data","getUrl","renderImages","iziToast","checkTotalHits","axios","Axios","imageTemplate","img","webformatURL","largeImageURL","tags","likes","views","comments","downloads","imagesTemplate","images","markup","SimpleLightbox","onBtnLoadClick","rect","totalHits"],"mappings":"owBASA,MAAMA,EAAO,CACT,OAAQ,SAAS,cAAc,OAAO,EACtC,MAAO,SAAS,cAAc,eAAe,EAC7C,UAAW,SAAS,cAAc,UAAU,EAC5C,OAAQ,SAAS,cAAc,SAAS,EACxC,QAAS,SAAS,cAAc,WAAW,CAE/C,EAEA,IAAIC,EAAQ,EACZ,MAAMC,EAAQ,GACd,IAAIC,EAAa,EACbC,EAAQ,GAEZJ,EAAK,OAAO,iBAAiB,SAAUK,CAAY,EACnDL,EAAK,OAAO,MAAM,WAAa,SAE/B,eAAeK,EAAaC,EAAG,CAC3BA,EAAE,eAAc,EAChBN,EAAK,UAAU,UAAY,GAC3BA,EAAK,QAAQ,MAAM,WAAa,SAChCI,EAAQE,EAAE,OAAO,SAAS,aAAa,MAAM,OACzCF,IAAU,KACVJ,EAAK,OAAO,MAAM,WAAa,WAEnCC,EAAQ,EACR,GAAI,CACA,MAAMM,EAAO,MAAMC,IACfD,EAAK,KAAK,OAAS,EAAIH,IAAU,IACjCJ,EAAK,OAAO,MAAM,WAAa,SAC/BS,EAAaF,EAAK,IAAI,EACtBP,EAAK,QAAQ,MAAM,WAAa,YAEhCA,EAAK,OAAO,MAAM,WAAa,SAC/BU,EAAS,MAAM,CACX,QAAS,2EACT,SAAU,UAC1B,CAAa,EAER,MAAa,CACVP,EAAa,EACbQ,EAAeR,CAAU,CAC5B,CACDG,EAAE,OAAO,OACb,CAGA,MAAMM,EAAQC,EAAM,OAAO,CACvB,QAAS,0BAEb,CAAC,EACD,eAAeL,GAAS,CAYpB,OAXgB,MAAMI,EAAM,IAAI,GAAG,CAAC,OAAQ,CACxC,IAAK,qCACL,EAAGR,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAUF,EACV,KAAMD,CAET,CACL,CAAK,GACe,IACpB,CACA,SAASa,EAAcC,EAAK,CACxB,KAAM,CAAC,aAAAC,EAAc,cAAAC,EAAe,KAAAC,EAAM,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,CAAS,EAAIP,EAC/E,MAAO;AAAA;AAAA;AAAA,eAGIE,CAAa;AAAA,gBACZD,CAAY,UAAUE,CAAI;AAAA;AAAA;AAAA;AAAA,gCAITC,CAAO;AAAA,gCACPC,CAAO;AAAA,mCACJC,CAAU;AAAA,oCACVC,CAAS;AAAA;AAAA;AAAA;AAAA,KAK7C,CACA,SAASC,EAAeC,EAAQ,CAC5B,OAAOA,EAAO,IAAIV,CAAa,EAAE,KAAK,EAAE,CAC5C,CACA,SAASL,EAAae,EAAQ,CAC1B,MAAMC,EAASF,EAAeC,CAAM,EACpCxB,EAAK,UAAU,mBAAmB,YAAYyB,CAAM,EAC/B,IAAIC,EAAe,aAAc,CAAE,aAAc,MAAO,aAAc,IAAK,EAAE,QAAU,CAChH,CAGA1B,EAAK,QAAQ,iBAAiB,QAAS2B,CAAc,EAErD,eAAeA,GAAiB,CAC5B1B,GAAS,EACTD,EAAK,OAAO,MAAM,WAAa,UAC/B,MAAMO,EAAO,MAAMC,IACnBC,EAAaF,EAAK,IAAI,EACtBI,EAAeJ,EAAK,SAAS,EAC7BP,EAAK,OAAO,MAAM,WAAa,SAE/B,IAAI4B,EAAO,EADE,SAAS,cAAc,OAAO,EACvB,sBAAqB,EAAG,OAC5C,OAAO,SAAS,CAChB,IAAKA,EACL,SAAU,QACd,CAAC,CACD,CAEA,SAASjB,EAAekB,EAAW,CAE/B,GADA1B,EAAa,KAAK,KAAK0B,EAAY3B,CAAK,EACpCC,GAAYF,EACZ,OAAAD,EAAK,QAAQ,MAAM,WAAa,SACzBU,EAAS,MAAM,CACtB,SAAU,WACV,MAAO,OACP,QAAS,8CACjB,CAAS,CAET"}